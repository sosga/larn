December 17 2015

1. Fixed segfault when picking up identified scrolls and potions (WIZARD and normal play).
2. Cleaned up several functions and removed unused variables.
3. Removed conio.h from the code and replaced it with a kbhit function.
4. Fixed closed doors blocking a WTW spell cast.
5. Added some extra text when being a cheapskate at a Holy Altar.

The game is now beatable and can be played normally.

~Gibbon

December 14 2015

1. A ton of fixes for segfaults
2. Fixed boolean bug preventing the player from falling down pits / bottomless pits
    Math used is now a much more reliable random function which around (1 / 20) times you will fall down a pit and much much less
    a bottomless pit.
3. Monster generation is partially fixed.  More than 1 monster will be generated OR 1 type randomly generated each time the game is loaded (possibility).
4. Player can now pickup scrolls and potions without segfaults (segfaults will still happen when in WIZARD mode (investigating).  But that is only for testing the game anyway.
5. Teleporting now works :)
6. Trapdoors are fixed and happen much more frequently.
7. Fixed segfault on OSX due to setmode.

~Gibbon

October 24 2015

1. OSX (Darwin) / BSD compatible defines implemented.
2. Darwin binary provided (64bit only)
3. Debug code fixed for Linux and Darwin
4. Linux Debug binary provided (Darwin in the next release)
5. Code cleanup and modernization continuing
6. Ammended the manual for the changes and new additions for the latest 12.50 version of Larn.  Removed a lot of 90's cruft about floppy disks and outdated installation methods.  It is also now a .odt.

Todo:
1. Rewrite the tgoto code to a free implementation

I want to re-license Larn, it is a bit of a pariah without any kind of license and some of the files don't allow commercial use.  Rewrites for these parts of the code should be done.

Darwin binary was built on OSX Mavericks using a freshly compiled ncurses 6.

~Gibbon
=============================================================================
October 11 2015

Changes:

1. setmode in io.c is only for Win32/BSD.  Linux does not have (or need) this function.  BSDs and Solaris systems will have this as it is a traditional UNIX function that is also in Windows.  I ifdef'd this so Linux systems won't even look at it.

2. I cleaned up and ported to modern compilers the conio.h file for linux.  This is included in the code as it is required for the kbhit function.  kbhit is a Windows-only function and this conio.h for Linux contains the definitions that are a direct equivalent of their Windows counterparts.  This is needed for checking for carriage returns, key presses etc.. correctly.  Comments are in polish but you don't need to read the code (unless you really want to).  Windows will continue to use it's own <conio.h> and will ignore this version.

I have included pdcurses.a and panel.a as well as the header files (pdcurses was compiled as 64bit only) so Windows users who are using 8+ (as it is usually 64bit) can use this 'as is'.  Linux and UNIX users can use ncurses.

The code still requires a large amount of cleaning up and modernizing, but for now it is playable and compiles.  I tested saving, scores etc and these are working correctly.

Enjoy :)

~Gibbon
=============================================================================

Larn 12.4


ANSIfication, ported to Curses, arrow key support,
message system fix, game over confirmation prompt, 
removal of platform-specific cruft, removal of most options,
name/sex prompt, ...

================================================================================

Larn 12.3.1

Prompted by Pat Ryan, fix a bug in the dropobj() code in main.c that
allowed the player to drop a negative amount of gold.  In the process, fix
the backwards carriage return logic when printing the error response.
Document the new SIG_RETURNS_INT #define introduced by Bill Randle when the
software was posted.
Prompted by Lasse Oestergaard, guard against out-of-bound array references
in movem.c when on the Home level.  Also fixed a bug where a 'smart' monster
would fail to move towards the player when the player was on the boundary.
Prompted by Mitch Gorman, make the EXTRA #define compile and work under
MS-DOS.

================================================================================

This is a list of the fixes and enhancements made to create Larn V12.3 from
Larn 12.2.  SPOILER ALERT!

1. The player's position is now marked with an ampersand, instead of just with
   the cursor.

2. The 'G' command ("give the stairs a kick") has been removed.  Since you can
   tell the stairs apart (as opposed to the original Larn 12.0), this command
   doesn't make sense anymore.

3. The 'V' command has been removed and its information incorporated into the
   'v' command.

4. An idea from Ultra-Larn: when the player enters the 5th level branch of the
   bank after teleporting, the '?' in the level display is changed to a '5'.

5. Larn -? can be used to print command line arguments.

6. The player is no longer positioned near the shaft of the volcano when
   climbing down to the first volcano level.

7. A couple of pauses were eliminated, making some actions very fast now.

8. The player can no longer escape punishment by donating more gold then he
   possesses when praying at the altar.

9. When performing an action and doing an inventory list, a character typed at
   the "press space for more" prompt is taken as the inventory item to select.
   That is, if you say 'q' for quaff, '*' to see all the potions you can quaff,
   Larn used to require that you type a space before you could select a potion,
   causing the list to disappear.  You can now select an item in the list while
   the list is displayed.  You can also use Escape and Return in place of a
   space.

10. The spells/potions/scrolls inventory ('I' command) are now sorted.

11. The '/' command has been added, to allow the user to identify objects.
    You can choose to either type a character or move the cursor around to
    select a character to identify (a la Hack).  The only limitation is that
    characters that have several objects (weapons, gems, dragons, etc) display
    all the matching object names.

12. The potion of gold detection has been changed into the potion of object
    detection.  It will find scrolls, books, potions, weapons, armor, and
    artifacts.  If you have an old savefile, all gold detection potions get
    turned into object detection potions.

13. It is now possible to find rings of cleverness in the dungeon.

14. It is now possible for killed monsters to drop splint mail, battle axes,
    cookies, and rings of cleverness.

15. Source cleanup, reduction in the size of the executable and the memory
    required, performance improvements.

16. Fix problems with positioning the player when entering or leaving the
    dungeon.  You will no longer find yourself on the opposite side of the
    town level when leaving the dungeon.  You will no longer be able to enter
    the dungeon on top of a monster.

17. Prevented monsters from moving into the dungeon entrance, causing them to
    be destroyed when the player exits the dungeon.  The top dungeon level now
    has the dungeon entrance character where there used to be a space.

18. If you are standing on a chest and try and open it, you will no longer pick
    it up immediately if you have auto-pickup on.

19. Added the capability to add comments to the options file.

20. Fixed the bug where a missing options file prevented anything from being
    displayed.

21. There is now a visible repeat count when greater than 10 (a la Hack).  You
    can also edit the repeat count.

22. The 'm' command has been added to move onto an object without picking it
    up (a la Hack).

23. Fixed a problem where the a) item in the inventory couldn't be dulled.

25. Allow a space between '-o' and the option filename.

26. Fix possible errors when looking at the inventory.

27. Prevent the player from changing levels into a level from the maze file with
    a space that had no means of exit.

================================================================================

This is a list of the fixes and enhancements made to create Larn V12.2 from
Larn 12.0.  SPOILER ALERT!

Changes made to create version 12.2 from 12.1:

1.  Add messages to improve feedback to the user.

2.  Improved screen drawing performance again.

3.  Flying monsters (bats, floating eyes) are no longer affected by traps.

4.  Added HACK-like objects, with 'original-objects' option.

5.  Added 'bold-objects' option.

6.  Fixed a bug where the game would apparently 'hang' for a long period of
    time, especially just after killing a monster with a missile spell.

7.  Prevented invulnerability when doing VPR on a throne or altar.

8.  Scrolls of pulverization now have the same affect when directed against
    an altar or fountain as they did directed against a throne.  VPR spell
    cause a waterlord to appear when used near a fountain.

9.  Added the '@' command and 'auto-pickup' option.

10. Added 'prompt-on-objects' option.

11. Improved monster movement performance again.

12. You can now weild '-' to unweild your weapon.

13. Waterlords can now be found in the dungeon, not just when washing at a
    fountain.

14. The Eye of Larn can now be sold in the Trading Post.

15. Spells can now bounce off mirrors at an angle.


Changes made to create version 12.1 from 12.0:

1.  When drinking at a fountain, "improved sight" caused the "see invisible"
    potion to be known by the player.  The player must now identify the potion
    in the usual manner.

2.  Falling through a pit told you the damage you received, but falling through
    a trap door did not.  Made trap doors act the same as pits.

3.  If you dropped a ring of dexterity/strength/cleverness that had been dulled
    to a negative amount, the corresponding stat was permanently increased.  No
    longer.

4.  The potion of monster location would show invisible monsters as the floor
    character on new levels.  Now prevented.

5.  Selling all your gems at the bank could destroy items in your inventory.

6.  Monster creation was being allowed on closed doors.  This was particularly
    a problem with treasure rooms, since it meant that a monster much too
    powerful for the player to handle was loose in the maze.  Monsters cannot
    now be created on closed doors.

7.  When entering a number (when entering gold amounts) you could not use the
    backspace key to delete digits.  Fixed.

8.  To make it more convenient when selling items in the Larn Trading Post, a
    display of those items in the players inventory that can be sold has been
    added.

9.  Performance of the display has been improved slightly.

10. Monster movement has been improved for large numbers of monsters.  It is
    somewhat better on PC's, even with aggravation.

11. I have added new mazes to LARN.MAZ.

12. A Rogue-like command mode has been added, and is the default.  The
    version 12.0 prompting mode has been preserved for those who like it,
    accessible via a command line option.  Command letters have been added
    to provide the ability to perform all the same actions as the prompt mode.
    The help file and command line help have been updated.  When in command
    mode, the player will automatically pick up objects, and can read, quaff,
    eat, look at, and pick up objects that you are standing on.

    In order to implement the new commands, the A and D commands from version
    12.0 have been changed.  They are now ^A and I.  For consistancy, to see
    the list of known spells at the spell prompt, 'I' also shows all known
    spells.
